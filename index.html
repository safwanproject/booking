<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>لوحة تحكم الإدارة</title>
    <!-- إضافة مكتبة Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-firestore.js"></script>

    <script>
        // إعداد Firebase باستخدام البيانات الخاصة بمشروعك
        const firebaseConfig = {
            apiKey: "AIzaSyCFWrAqn83uXEnOhCsuVCk6xJZHnEN2bjs",
            authDomain: "new-project-bd577.firebaseapp.com",
            projectId: "new-project-bd577",
            storageBucket: "new-project-bd577.appspot.com",
            messagingSenderId: "927819600447",
            appId: "1:927819600447:web:62f7b0fe5648be01f3cb0d"
        };

        // تهيئة Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore(); // الوصول إلى Firestore
    </script>

    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            direction: rtl; /* اتجاه النص من اليمين لليسار */
        }
        .container {
            padding: 20px;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
        }
        input, select, button {
            width: 100%;
            padding: 8px;
            margin: 5px 0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
        }
        th {
            background-color: #f4f4f4;
        }
        .show-more {
            margin-top: 20px;
            padding: 10px;
            background-color: #f4f4f4;
            border: 1px solid #ddd;
            cursor: pointer;
        }
        .image {
            width: 100%;
            height: auto;
            object-fit: cover;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>لوحة تحكم الإدارة</h1>
        <div>
            <h2>إضافة أو تعديل البيانات</h2>
            <div class="form-group">
                <label for="country">الدولة</label>
                <input type="text" id="country" placeholder="أدخل اسم الدولة">
            </div>
            <div class="form-group">
                <label for="city">المدينة</label>
                <input type="text" id="city" placeholder="أدخل اسم المدينة">
            </div>
            <div class="form-group">
                <label for="school">المدرسة</label>
                <input type="text" id="school" placeholder="أدخل اسم المدرسة">
            </div>
            <div class="form-group">
                <label for="schoolImage">رابط صورة المدرسة</label>
                <input type="text" id="schoolImage" placeholder="أدخل رابط صورة المدرسة">
            </div>
            <div class="form-group">
                <label for="schoolDescription">وصف المدرسة</label>
                <input type="text" id="schoolDescription" placeholder="أدخل وصف المدرسة">
            </div>
            <div class="form-group">
                <label for="course">الدورة الدراسية</label>
                <input type="text" id="course" placeholder="أدخل اسم الدورة">
            </div>
            <div class="form-group">
                <label for="weeks">عدد الأسابيع</label>
                <select id="weeks">
                    <option value="4">4 أسابيع</option>
                    <option value="6">6 أسابيع</option>
                    <option value="8">8 أسابيع</option>
                    <option value="12">12 أسبوعًا</option>
                    <option value="16">16 أسبوعًا</option>
                    <option value="20">20 أسبوعًا</option>
                    <option value="24">24 أسبوعًا</option>
                </select>
            </div>
            <div class="form-group">
                <label for="studyFees">رسوم الدراسة</label>
                <input type="number" id="studyFees" placeholder="أدخل رسوم الدراسة">
            </div>
            <div class="form-group">
                <label for="accommodation">عدد أسابيع الإقامة</label>
                <select id="accommodation">
                    <option value="4">4 أسابيع</option>
                    <option value="6">6 أسابيع</option>
                    <option value="8">8 أسابيع</option>
                    <option value="12">12 أسبوعًا</option>
                    <option value="16">16 أسبوعًا</option>
                    <option value="20">20 أسبوعًا</option>
                    <option value="24">24 أسبوعًا</option>
                </select>
            </div>
            <div class="form-group">
                <label for="accommodationFees">رسوم الإقامة</label>
                <input type="number" id="accommodationFees" placeholder="أدخل رسوم الإقامة">
            </div>
            <div class="form-group">
                <label for="insuranceFees">رسوم التأمين</label>
                <input type="number" id="insuranceFees" placeholder="أدخل رسوم التأمين">
            </div>
            <div class="form-group">
                <label for="airportPickupFees">رسوم النقل من المطار</label>
                <input type="number" id="airportPickupFees" placeholder="أدخل رسوم النقل من المطار">
            </div>
            <button onclick="addData()">إضافة/تحديث البيانات</button>
        </div>
        <div>
            <h2>بحث البيانات</h2>
            <input type="text" id="search" placeholder="ابحث عن الدولة أو المدينة أو المدرسة أو الدورة" onkeyup="searchData()">
        </div>
        <div>
            <h2>قائمة البيانات</h2>
            <table id="dataTable">
                <thead>
                    <tr>
                        <th>الدولة</th>
                        <th>المدرسة</th>
                        <th>صورة المدرسة</th>
                        <th>وصف المدرسة</th>
                        <th>الدورة الدراسية</th>
                        <th>الأسابيع</th>
                        <th>رسوم الدراسة</th>
                        <th>أسابيع الإقامة</th>
                        <th>رسوم الإقامة</th>
                        <th>رسوم التأمين</th>
                        <th>رسوم النقل من المطار</th>
                        <th>الإجراءات</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Data rows will appear here -->
                </tbody>
            </table>
            <button class="show-more" onclick="showMore()">عرض المزيد</button>
        </div>
    </div>
    
    <script>
        // دالة لإضافة البيانات إلى Firestore
        function addData() {
            const country = document.getElementById('country').value;
            const city = document.getElementById('city').value;
            const school = document.getElementById('school').value;
            const schoolImage = document.getElementById('schoolImage').value;
            const schoolDescription = document.getElementById('schoolDescription').value;
            const course = document.getElementById('course').value;
            const weeks = document.getElementById('weeks').value;
            const studyFees = document.getElementById('studyFees').value;
            const accommodation = document.getElementById('accommodation').value;
            const accommodationFees = document.getElementById('accommodationFees').value;
            const insuranceFees = document.getElementById('insuranceFees').value;
            const airportPickupFees = document.getElementById('airportPickupFees').value;

            // التحقق من البيانات المدخلة
            if (country && city && school && course && weeks && studyFees && accommodation && accommodationFees && insuranceFees && airportPickupFees) {
                // إضافة البيانات إلى Firestore
                db.collection("schoolData").add({
                    country,
                    city,
                    school,
                    schoolImage,
                    schoolDescription,
                    course,
                    weeks,
                    studyFees,
                    accommodation,
                    accommodationFees,
                    insuranceFees,
                    airportPickupFees
                })
                .then(() => {
                    alert("تم إضافة البيانات بنجاح!");
                    clearForm(); // مسح البيانات المدخلة
                    displayData(); // تحديث عرض البيانات
                })
                .catch((error) => {
                    console.error("خطأ في إضافة البيانات: ", error);
                });
            } else {
                alert("يرجى ملء جميع الحقول.");
            }
        }

        // دالة لعرض البيانات المسترجعة من Firestore في الجدول
        function displayData() {
            const tableBody = document.getElementById('dataTable').querySelector('tbody');
            tableBody.innerHTML = '';  // مسح البيانات السابقة في الجدول

            // استرجاع البيانات من Firestore
            db.collection("schoolData").get().then((querySnapshot) => {
                querySnapshot.forEach((doc) => {
                    const entry = doc.data();  // الحصول على بيانات كل مستند
                    const row = `
                        <tr>
                            <td>${entry.country}</td>
                            <td>${entry.school}</td>
                            <td><img src="${entry.schoolImage}" alt="${entry.school}" class="image"></td>
                            <td>${entry.schoolDescription}</td>
                            <td>${entry.course}</td>
                            <td>${entry.weeks}</td>
                            <td>${entry.studyFees}</td>
                            <td>${entry.accommodation}</td>
                            <td>${entry.accommodationFees}</td>
                            <td>${entry.insuranceFees}</td>
                            <td>${entry.airportPickupFees}</td>
                            <td>
                                <button onclick="editData('${doc.id}')">تعديل</button>
                                <button onclick="deleteData('${doc.id}')">حذف</button>
                            </td>
                        </tr>
                    `;
                    tableBody.innerHTML += row;
                });
            }).catch((error) => {
                console.error("خطأ في استرجاع البيانات: ", error);
            });
        }

        // دالة للبحث عن البيانات
        function searchData() {
            const query = document.getElementById('search').value.toLowerCase();
            const rows = document.querySelectorAll('#dataTable tbody tr');

            rows.forEach(row => {
                const cells = row.querySelectorAll('td');
                const found = Array.from(cells).some(cell => cell.textContent.toLowerCase().includes(query));
                row.style.display = found ? '' : 'none';
            });
        }

        // دالة لمسح البيانات المدخلة
        function clearForm() {
            document.getElementById('country').value = '';
            document.getElementById('city').value = '';
            document.getElementById('school').value = '';
            document.getElementById('schoolImage').value = '';
            document.getElementById('schoolDescription').value = '';
            document.getElementById('course').value = '';
            document.getElementById('weeks').value = '4';
            document.getElementById('studyFees').value = '';
            document.getElementById('accommodation').value = '4';
            document.getElementById('accommodationFees').value = '';
            document.getElementById('insuranceFees').value = '';
            document.getElementById('airportPickupFees').value = '';
        }

        // دالة لعرض المزيد من البيانات في الجدول
        function showMore() {
            displayData();
        }

        // استدعاء الدالة لعرض البيانات عند تحميل الصفحة
        window.onload = function() {
            displayData();
        };
    </script>
</body>
</html>
